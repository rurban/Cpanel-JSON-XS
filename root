{"version":1,"ops":[{"type":1,"author":{"id":"91e41b119e7e533de326580fd48f9281bdfb3d49"},"timestamp":1552087253,"metadata":{"github-id":"MDU6SXNzdWU0MTg5OTUzODE=","github-url":"https://github.com/rurban/Cpanel-JSON-XS/issues/123","origin":"github"},"title":"Get core dumps on incr_reset","message":"Hello,\n\nI'm getting segfaults within our application, caused by Cpanel::JSON::XS.\n\n```\nFeb 19 07:53:42 minion27 kernel: [5259146.262057] perl-fcgi[8792]: segfault at 219 ip 00007f8f54bc115e sp 00007ffeb39361e0 error 4 in XS.so[7f8f54bbe000+12000]\n```\n\nI've enabled core dumps (see below). I'm not the biggest gdb hero, so I'm unable to determine what the cause is. I'm looking into ways for troubleshooting this, but I'm unable to reproduce this issue on my local machine with the same Docker image. I've tried editting XS.xs to see what the caller is of this function before it segfaults, but I'm not seeing much in my logs. Any help is appreciated!\n\n```\nroot@7fb9efefe933:/usr/src/Cpanel-JSON-XS-4.06# perl -v\nThis is perl 5, version 26, subversion 1 (v5.26.1) built for x86_64-linux-gnu\n\nroot@7fb9efefe933:/usr/src/Cpanel-JSON-XS-4.06# perl -MV=Cpanel::JSON::XS,JSON,JSON::XS\nCpanel::JSON::XS\n/usr/local/lib/perl5/site_perl/5.26.1/x86_64-linux-gnu/Cpanel/JSON/XS.pm: 4.06\nJSON\n/usr/local/lib/perl5/site_perl/5.26.1/JSON.pm: 2.97001\nJSON::XS\n/usr/local/lib/perl5/site_perl/5.26.1/x86_64-linux-gnu/JSON/XS.pm: 3.04\n\n\n(gdb) bt full\n#0  0x00007f4d638c215e in XS_Cpanel__JSON__XS_incr_reset (cv=\u003coptimized out\u003e) at XS.c:5182\nself = \u003coptimized out\u003e\nsp = 0x555b36f13888\nax = 1477029232\nmark = 0x555e18455828\nitems = -1546290164\n#1  0x00007f4d673d7dc3 in Perl_pp_entersub () from /usr/local/lib/perl5/5.26.1/x86_64-linux-gnu/CORE/libperl.so\nNo symbol table info available.\n#2  0x00007f4d67353505 in Perl_call_sv () from /usr/local/lib/perl5/5.26.1/x86_64-linux-gnu/CORE/libperl.so\nNo symbol table info available.\n#3  0x00007f4d673dc8ec in S_curse () from /usr/local/lib/perl5/5.26.1/x86_64-linux-gnu/CORE/libperl.so\nNo symbol table info available.\n#4  0x00007f4d673dd2cd in Perl_sv_clear () from /usr/local/lib/perl5/5.26.1/x86_64-linux-gnu/CORE/libperl.so\nNo symbol table info available.\n#5  0x00007f4d673dd5b2 in Perl_sv_free2 () from /usr/local/lib/perl5/5.26.1/x86_64-linux-gnu/CORE/libperl.so\nNo symbol table info available.\n#6  0x00007f4d673e8138 in Perl_sv_rvweaken () from /usr/local/lib/perl5/5.26.1/x86_64-linux-gnu/CORE/libperl.so\nNo symbol table info available.\n#7  0x00007f4d65fdabd7 in XS_Scalar__Util_weaken () from /usr/local/lib/perl5/site_perl/5.26.1/x86_64-linux-gnu/auto/List/Util/Util.so\nNo symbol table info available.\n#8  0x00007f4d673d7dc3 in Perl_pp_entersub () from /usr/local/lib/perl5/5.26.1/x86_64-linux-gnu/CORE/libperl.so\nNo symbol table info available.\n#9  0x00007f4d673cf8f3 in Perl_runops_standard () from /usr/local/lib/perl5/5.26.1/x86_64-linux-gnu/CORE/libperl.so\nNo symbol table info available.\n#10 0x00007f4d673536d1 in Perl_call_sv () from /usr/local/lib/perl5/5.26.1/x86_64-linux-gnu/CORE/libperl.so\nNo symbol table info available.\n#11 0x00007f4d673dc8ec in S_curse () from /usr/local/lib/perl5/5.26.1/x86_64-linux-gnu/CORE/libperl.so\nNo symbol table info available.\n#12 0x00007f4d673dd2cd in Perl_sv_clear () from /usr/local/lib/perl5/5.26.1/x86_64-linux-gnu/CORE/libperl.so\nNo symbol table info available.\n#13 0x00007f4d673dd5b2 in Perl_sv_free2 () from /usr/local/lib/perl5/5.26.1/x86_64-linux-gnu/CORE/libperl.so\nNo symbol table info available.\n#14 0x00007f4d67408d96 in Perl_leave_scope () from /usr/local/lib/perl5/5.26.1/x86_64-linux-gnu/CORE/libperl.so\nNo symbol table info available.\n#15 0x00007f4d673d77f1 in Perl_pp_leavesub () from /usr/local/lib/perl5/5.26.1/x86_64-linux-gnu/CORE/libperl.so\nNo symbol table info available.\n#16 0x00007f4d673cf8f3 in Perl_runops_standard () from /usr/local/lib/perl5/5.26.1/x86_64-linux-gnu/CORE/libperl.so\nNo symbol table info available.\n#17 0x00007f4d6735a78b in perl_run () from /usr/local/lib/perl5/5.26.1/x86_64-linux-gnu/CORE/libperl.so\nNo symbol table info available.\n#18 0x0000555b0be76e5b in main (argc=\u003coptimized out\u003e, argv=\u003coptimized out\u003e, env=\u003coptimized out\u003e) at perlmain.c:123\nexitstatus = \u003coptimized out\u003e\ni = \u003coptimized out\u003e\n```","files":null}]}