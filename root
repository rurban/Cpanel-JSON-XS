{"version":1,"ops":[{"type":1,"author":{"id":"d19730b1d47a47ba43733401ca1bc3d2bbb7f976"},"timestamp":1448901939,"metadata":{"github-id":"MDU6SXNzdWUxMTk1MzE1ODk=","github-url":"https://github.com/rurban/Cpanel-JSON-XS/issues/49","origin":"github"},"title":"Inconsistency in scalar ref encoding in 3.0206","message":"Still something off with convert_blessed/allow_blessed and unblessed scalar refs. (which should not be affected by these options; all of these cases should throw an exception because allow_unknown is not enabled)\n\n```\n$ perl -MCpanel::JSON::XS -E'say Cpanel::JSON::XS-\u003enew-\u003eencode({false =\u003e \\\"\"})'\ncannot encode reference to scalar 'SCALAR(0x16e6c70)' unless the scalar is 0 or 1 at -e line 1.\n$ perl -MCpanel::JSON::XS -E'say Cpanel::JSON::XS-\u003enew-\u003eallow_blessed-\u003eencode({false =\u003e \\\"\"})'\ncannot encode reference to scalar 'SCALAR(0x1fd2928)' unless the scalar is 0 or 1 at -e line 1.\n$ perl -MCpanel::JSON::XS -E'say Cpanel::JSON::XS-\u003enew-\u003econvert_blessed-\u003eencode({false =\u003e \\\"\"})'\n{\"false\":null}\n$ perl -MCpanel::JSON::XS -E'say Cpanel::JSON::XS-\u003enew-\u003eallow_blessed-\u003econvert_blessed-\u003eencode({false =\u003e \\\"\"})'\n{\"false\":null}\n\n$ perl -MCpanel::JSON::XS -E'say Cpanel::JSON::XS-\u003enew-\u003eencode({true =\u003e \\\"some true value\"})'\ncannot encode reference to scalar 'SCALAR(0x152ac80)' unless the scalar is 0 or 1 at -e line 1.\n$ perl -MCpanel::JSON::XS -E'say Cpanel::JSON::XS-\u003enew-\u003eallow_blessed-\u003eencode({true =\u003e \\\"some true value\"})'\ncannot encode reference to scalar 'SCALAR(0x2132918)' unless the scalar is 0 or 1 at -e line 1.\n$ perl -MCpanel::JSON::XS -E'say Cpanel::JSON::XS-\u003enew-\u003econvert_blessed-\u003eencode({true =\u003e \\\"some true value\"})'\n{\"true\":null}\n$ perl -MCpanel::JSON::XS -E'say Cpanel::JSON::XS-\u003enew-\u003eallow_blessed-\u003econvert_blessed-\u003eencode({true =\u003e \\\"some true value\"})'\n{\"true\":\"some true value\"}\n```\n\nThis last case is also inconsistent because unlike all the other cases, the scalar ref does not encode to null with allow_unknown and both other options enabled (it encodes to the same string)\n\n```\n$ perl -MCpanel::JSON::XS -E'say Cpanel::JSON::XS-\u003enew-\u003eallow_unknown-\u003eencode({true =\u003e \\\"some true value\"})'\n{\"true\":null}\n$ perl -MCpanel::JSON::XS -E'say Cpanel::JSON::XS-\u003enew-\u003eallow_unknown-\u003eallow_blessed-\u003econvert_blessed-\u003eencode({true =\u003e \\\"some true value\"})'\n{\"true\":\"some true value\"}\n```","files":null}]}